# Excel文件比较工具使用说明
## 程序概述

Excel文件比较工具是一个基于Python开发的图形界面应用程序，用于比较两个Excel文件的内容差异。该工具能够智能识别行内容差异，生成详细的差异报告，并通过颜色编码帮助用户快速定位不同之处。

### 功能特点

✅ 多工作表支持 - 自动比较两个Excel文件中的所有工作表

✅ 智能行匹配 - 不考虑行顺序，按内容进行匹配

✅ 三种差异类型识别：

> - 仅存在于文件1的行
>
> - 仅存在于文件2的行
>
> - 内容不同的行（部分单元格不一致）

✅ 可视化差异报告 - 使用颜色编码突出显示差异

✅ 自动保存 - 差异报告自动保存在文件2所在文件夹

## 使用步骤

### 1. 启动程序

双击可执行文件或运行Python脚本

程序窗口将打开，显示文件选择界面

### 2. 选择要比较的文件

点击"浏览"按钮选择第一个Excel文件（文件1）

点击"浏览"按钮选择第二个Excel文件（文件2）

文件路径将显示在对应的文本框中

### 3. 开始比较

点击"开始比较"按钮

程序将显示比较进度和状态

比较过程日志将显示在结果区域

### 4. 查看比较结果

比较完成后，程序将显示统计信息：

完全相同行数

仅存在于文件1行数

仅存在于文件2行数

内容不同行数

差异报告将自动保存到文件2所在文件夹

## 输出报告说明

### 文件位置
差异报告保存在文件2所在的文件夹

文件命名格式：[文件2名称]_比较结果.xlsx

如果文件已存在，会自动添加序号避免覆盖

### 报告格式

#### 列结构

工作表 - 差异所在的工作表名称

文件1行号 - 在文件1中的原始行号

文件2行号 - 在文件2中的原始行号

差异类型 - 标识差异类型

数据列 - 每个原始数据列分为两列：

[列名] (文件1) - 文件1中的值

[列名] (文件2) - 文件2中的值

#### 颜色编码

| 颜色 | 应用位置 | 含义
| :----- | :----- | :----- |
| 🟨 黄色背景 | 内容不同的单元格 | 该单元格在两个文件中内容不同 |
| 🟩 浅绿色背景 | 仅存在于文件1的行的文件1行号 | 此行仅存在于文件1 |
| 🟦 浅蓝色背景 | 仅存在于文件2的行的文件2行号 | 此行仅存在于文件2 |

## 比较逻辑说明

### 行匹配规则

- 完全相同的行 - 所有单元格内容完全相同

- 内容不同的行 - 超过半数单元格内容相同，但部分单元格不同

- 仅存在于文件1的行 - 在文件2中完全找不到相似匹配的行

- 仅存在于文件2的行 - 在文件1中完全找不到相似匹配的行

### 相似行判定

- 当一行中超过半数的单元格内容相同时，认为是相似行

- 相似行被归类为"内容不同"，而不是"缺失行"

- 只有完全找不到相似匹配的行才被归类为缺失行

## 常见问题解答

Q: 程序无法启动怎么办？

A:

> 确保系统满足基本要求
>
> 如果运行Python源代码，检查是否安装了所有依赖库
>
>尝试以管理员权限运行程序

Q: 比较过程很慢怎么办？

A:

> 大型Excel文件比较可能需要较长时间
>
> 关闭其他占用资源的应用程序
>
> 如果文件特别大，考虑先拆分再比较

Q: 差异报告没有正确显示颜色怎么办？

A:

> 确保使用Microsoft Excel 2007或更高版本查看
>
> 其他电子表格软件可能不支持某些格式

Q: 程序报告"文件不存在"错误怎么办？

A:

> 检查文件路径是否正确
>
> 确保文件没有被其他程序打开
>
> 检查文件权限

Q: 如何比较特定工作表？

A:

> 程序会自动比较所有同名工作表
>
> 要比较特定工作表，可以先将其他工作表删除或移动到单独文件

## 技术细节

### 支持的Excel格式

.xlsx (Excel 2007及更高版本)

.xls (Excel 97-2003)

### 限制

最大支持约100万行数据（受限于pandas和系统内存）

不支持加密或受密码保护的Excel文件

不支持宏和VBA代码比较

### 故障排除

> 内存不足错误
>
> - 关闭其他应用程序释放内存
>
> - 考虑分批比较大型文件
>
> - 增加系统虚拟内存

> 文件读取错误
>
> - 确保文件没有被损坏
>
> - 尝试用Excel打开并重新保存文件
>
> - 检查文件扩展名是否正确

> 程序无响应
>
> - 大型文件比较可能需要较长时间
>
> - 检查任务管理器确认程序仍在运行
>
> - 耐心等待比较完成

## 更新日志

版本 1.0

初始发布版本

基本文件比较功能

多工作表支持

颜色编码差异报告